#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ‘¥ Running admin onboarding security validation..."

# 1. RBAC configuration check
echo "ğŸ”’ Validating role-based access controls..."
npm run validate:rbac-config

# 2. Financial endpoint security validation
echo "ğŸ’° Checking financial endpoint permissions..."
npm run validate:financial-endpoints

# 3. Data masking rules validation
echo "ğŸ­ Validating data masking configurations..."
npm run validate:data-masking

# 4. Audit trail setup verification
echo "ğŸ“‹ Verifying audit trail configuration..."
npm run validate:audit-trail

# 5. Test role permissions
echo "ğŸ§ª Testing role-based permissions..."
node scripts/security/test-role-permissions.js

# 6. Generate security report
echo "ğŸ“Š Generating security compliance report..."
node scripts/security/generate-security-report.js

echo "âœ… Admin onboarding security validation complete!"
echo "ğŸ›¡ï¸ All financial data properly protected from unauthorized access"